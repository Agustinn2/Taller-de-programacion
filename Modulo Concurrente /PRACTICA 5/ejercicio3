programa ejercicio3
procesos
  proceso recogerFlor(ES cantFlores: numero)
  comenzar
    si(HayFlorEnLaEsquina)
      tomarFlor
      cantFlores:=cantFlores + 1
  fin
  proceso avanzar (ES cantFlores:numero)
  comenzar
    recogerFlor(cantFlores)
    si(cantFlores <> 10)
      mover
  fin
  proceso vaciarBolsa(ES cantFlores:numero)
  variables
    miAv,miCa:numero
  comenzar
    miAv:=PosAv
    miCa:=PosCa
    BloquearEsquina(10,10)
    Pos(10,10)
    repetir cantFlores
      depositarFlor
    Pos(miAv,miCa)
    LiberarEsquina(10,10)
    EnviarMensaje(cantFlores,r0)
    cantFlores:=0
  fin
  proceso juntarFlores (E cant:numero)
  variables
    av,ca:numero
  comenzar
    av:=PosAv
    ca:=PosCa
    BloquearEsquina(10,10)
    Pos(10,10)
    repetir cant
      tomarFlor
    Pos(av,ca)
    LiberarEsquina(10,10)
  fin
areas
  areaR1: AreaP (1,3,100,3)
  areaR2: AreaP (1,4,100,4)
  areaJefe: AreaP (1,5,1,5)
  areaDeposito: AreaC (10,10,10,10)
robots
  robot recolectores
  variables
    cantFlores,esquina:numero
  comenzar
    derecha
    cantFlores:=0
    esquina:=15
    mientras(PosAv < 100)
      si((cantFlores <> 10) & (PosAv < esquina))
        avanzar(cantFlores)
      sino
        vaciarBolsa(cantFlores)
        si(PosAv = esquina)
          esquina:= esquina  + 15
    EnviarMensaje(11,r0)
  fin
  robot cosechador
  variables
    cant,total,terminados:numero
  comenzar
    total:=0
    terminados:=0
    mientras(terminados <> 2)
      RecibirMensaje(cant,*)
      si(cant <> 11)
        total:= total + cant
        juntarFlores(cant)
      sino 
        terminados := terminados + 1
    Informar(total)
  fin
variables
  r1,r2: recolectores
  r0: cosechador
comenzar
  AsignarArea(r1, areaR1)
  AsignarArea(r2, areaR2)
  AsignarArea(r0, areaJefe)
  AsignarArea(r1, areaDeposito)
  AsignarArea(r2, areaDeposito)
  AsignarArea(r0, areaDeposito)
  Iniciar(r1, 1,3)
  Iniciar(r2, 1,4)
  Iniciar(r0, 1,5)
fin